# パーツ・強化システム バランス設計書

**作成日**: 2025-11-26
**Phase**: 3 - 成長システム
**目的**: 実装可能な具体的数値を含む成長システムの完全仕様策定

---

## 1. パーツカテゴリと具体的パーツ設計

### 1.1 武器系（Weapons）

#### パーツ1: レーザーキャノン（Laser Cannon）
**コンセプト**: 攻撃力を上げる基本パーツ

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (初期) | ダメージ: 1発で敵撃破 | - | 現状維持 |
| Lv.1 | ダメージ: 1.0倍（変化なし）<br>射程距離: +20% | 50pt | 遠距離から安全に撃破可能 |
| Lv.2 | ダメージ: 1.0倍<br>射程距離: +40%<br>弾速: +30% | 120pt | さらに遠くから、速い弾で |
| Lv.3 | ダメージ: 2.0倍（重敵対応）<br>射程距離: +60%<br>弾速: +50% | 250pt | 後述の重装甲敵に有効 |

**実装パラメータ**:
```typescript
interface LaserCannonStats {
  damage: number        // Lv.0:1, Lv.1-2:1, Lv.3:2
  range: number         // Lv.0:50, Lv.1:60, Lv.2:70, Lv.3:80
  bulletSpeed: number   // Lv.0:40, Lv.1:40, Lv.2:52, Lv.3:60
}
```

#### パーツ2: マルチショット（Multi-Shot）
**コンセプト**: 連射速度・同時発射数を上げる

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | - | - | - |
| Lv.1 | 連射速度: -20%（0.144秒間隔）<br>単発 | 80pt | 初期0.18秒から短縮 |
| Lv.2 | 連射速度: -35%（0.117秒間隔）<br>単発 | 180pt | さらに高速化 |
| Lv.3 | 連射速度: -20%（0.144秒）<br>2連射（左右から発射） | 350pt | 弾幕形成可能 |

**実装パラメータ**:
```typescript
interface MultiShotStats {
  fireInterval: number  // Lv.0:0.18, Lv.1:0.144, Lv.2:0.117, Lv.3:0.144
  bulletCount: number   // Lv.0-2:1, Lv.3:2
  spreadAngle: number   // Lv.0-2:0, Lv.3:15 (degrees)
}
```

#### パーツ3: ホーミングミサイル（Homing Missile）
**コンセプト**: 特殊武器、追尾機能

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | - | - | - |
| Lv.1 | ホーミング発動（低精度）<br>連射不可（2秒間隔） | 150pt | 初心者救済 |
| Lv.2 | ホーミング精度UP<br>1.5秒間隔 | 300pt | より確実に当たる |
| Lv.3 | ホーミング高精度<br>1.2秒間隔<br>ダメージ2倍 | 500pt | ボス戦で有効 |

**実装パラメータ**:
```typescript
interface HomingMissileStats {
  turnRate: number      // Lv.1:2.0, Lv.2:3.5, Lv.3:5.0 (rad/s)
  fireInterval: number  // Lv.1:2.0, Lv.2:1.5, Lv.3:1.2
  damage: number        // Lv.1-2:1, Lv.3:2
  lockRange: number     // Lv.1:30, Lv.2:40, Lv.3:50
}
```

---

### 1.2 防御系（Defense）

#### パーツ4: シールドジェネレーター（Shield Generator）
**コンセプト**: 最大HPを増やす

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (初期) | HP: 100 | - | 現状維持 |
| Lv.1 | HP: 120 (+20) | 60pt | 敵2体分の余裕 |
| Lv.2 | HP: 150 (+50) | 140pt | 敵5体分の余裕 |
| Lv.3 | HP: 200 (+100) | 280pt | ボス戦耐久 |

**実装パラメータ**:
```typescript
interface ShieldStats {
  maxHP: number  // Lv.0:100, Lv.1:120, Lv.2:150, Lv.3:200
}
```

#### パーツ5: アーマープレート（Armor Plate）
**コンセプト**: 被ダメージ軽減

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | ダメージ軽減: 0% | - | - |
| Lv.1 | ダメージ軽減: 20%（8ダメージ） | 70pt | 敵10発→12.5発に |
| Lv.2 | ダメージ軽減: 35%（6.5ダメージ） | 160pt | 敵10発→15.4発に |
| Lv.3 | ダメージ軽減: 50%（5ダメージ） | 320pt | 敵10発→20発に |

**実装パラメータ**:
```typescript
interface ArmorStats {
  damageReduction: number  // Lv.0:0, Lv.1:0.2, Lv.2:0.35, Lv.3:0.5
}
```

#### パーツ6: オートリペア（Auto-Repair）
**コンセプト**: HP自動回復

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | 回復: なし | - | - |
| Lv.1 | 5秒ごとに +5 HP回復 | 100pt | 長期戦で有利 |
| Lv.2 | 4秒ごとに +8 HP回復 | 220pt | 回復速度UP |
| Lv.3 | 3秒ごとに +12 HP回復 | 450pt | ボス戦での継戦能力 |

**実装パラメータ**:
```typescript
interface AutoRepairStats {
  healInterval: number  // Lv.0:0, Lv.1:5, Lv.2:4, Lv.3:3
  healAmount: number    // Lv.0:0, Lv.1:5, Lv.2:8, Lv.3:12
}
```

---

### 1.3 機動系（Mobility）

#### パーツ7: ブースター（Booster）
**コンセプト**: 移動速度アップ

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (初期) | 移動速度: 12 units/s | - | 現状維持 |
| Lv.1 | 移動速度: 14.4 (+20%) | 40pt | 敵弾回避しやすく |
| Lv.2 | 移動速度: 16.8 (+40%) | 100pt | 機動力大幅UP |
| Lv.3 | 移動速度: 19.2 (+60%) | 200pt | 最高速度 |

**実装パラメータ**:
```typescript
interface BoosterStats {
  moveSpeed: number  // Lv.0:12, Lv.1:14.4, Lv.2:16.8, Lv.3:19.2
}
```

#### パーツ8: クイックターン（Quick Turn）
**コンセプト**: 旋回速度・照準速度アップ

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (初期) | 照準補間: 0.35 | - | 現状維持 |
| Lv.1 | 照準補間: 0.50 (+43%) | 50pt | 素早く狙える |
| Lv.2 | 照準補間: 0.65 (+86%) | 110pt | さらに素早く |
| Lv.3 | 照準補間: 0.80 (+129%) | 230pt | 即座に照準 |

**実装パラメータ**:
```typescript
interface QuickTurnStats {
  aimLerp: number  // Lv.0:0.35, Lv.1:0.50, Lv.2:0.65, Lv.3:0.80
}
```

---

### 1.4 特殊系（Special）

#### パーツ9: スコアブースター（Score Booster）
**コンセプト**: 獲得スコア倍率UP

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | スコア倍率: 1.0x | - | - |
| Lv.1 | スコア倍率: 1.3x（13pt/撃破） | 90pt | 回収重視 |
| Lv.2 | スコア倍率: 1.6x（16pt/撃破） | 200pt | さらに効率的 |
| Lv.3 | スコア倍率: 2.0x（20pt/撃破） | 400pt | 最大効率 |

**実装パラメータ**:
```typescript
interface ScoreBoosterStats {
  scoreMultiplier: number  // Lv.0:1.0, Lv.1:1.3, Lv.2:1.6, Lv.3:2.0
}
```

#### パーツ10: シールドリチャージ（Shield Recharge）
**コンセプト**: ダメージ無しで一定時間経過後、シールド再生

| 強化段階 | 効果 | 価格 | 備考 |
|---------|------|------|------|
| Lv.0 (未装備) | - | - | - |
| Lv.1 | 5秒無傷で30%シールド回復 | 120pt | 防御的プレイで有効 |
| Lv.2 | 4秒無傷で50%シールド回復 | 260pt | より短時間で |
| Lv.3 | 3秒無傷で80%シールド回復 | 520pt | ほぼ全回復 |

**実装パラメータ**:
```typescript
interface ShieldRechargeStats {
  rechargeCooldown: number    // Lv.0:0, Lv.1:5, Lv.2:4, Lv.3:3
  rechargePercent: number     // Lv.0:0, Lv.1:0.3, Lv.2:0.5, Lv.3:0.8
}
```

---

## 2. 強化段階システム

### 2.1 段階数と設計思想

**採用: 4段階システム（Lv.0 → Lv.1 → Lv.2 → Lv.3）**

#### 理由:
1. **Lv.0（初期状態/未装備）**: ベースライン
2. **Lv.1（初級強化）**: 少額投資で効果実感、「次も欲しい」と思わせる
3. **Lv.2（中級強化）**: 明確な性能向上、プレイスタイル確立
4. **Lv.3（最終強化）**: エンドコンテンツ、ボス戦で真価を発揮

**段階ごとの効果倍率設計思想**:
- Lv.1: 控えめ（+20~40%）、体験版的な効果
- Lv.2: 実用的（+40~80%）、ゲームプレイが変わる
- Lv.3: 劇的（+60~200%）、「完成形」の達成感

### 2.2 ボスドロップ素材の扱い

**採用: Lv.3強化に「ボスコア」必須**

| パーツカテゴリ | Lv.3強化に必要なボスコア数 |
|--------------|---------------------------|
| 武器系 | 1個 |
| 防御系 | 1個 |
| 機動系 | 1個 |
| 特殊系 | 2個 |

**ボスコア入手方法**:
- 1体目のボス撃破: 2個
- 2体目のボス撃破: 3個
- 3体目以降: 2個ずつ

**設計意図**:
- ボス戦へのモチベーション付け
- Lv.3強化を「特別な報酬」として位置づける
- 全パーツをLv.3にするには複数回ボス撃破が必要（やりこみ要素）

---

## 3. 価格バランス設計

### 3.1 基準となる収益モデル

**前提**:
- 敵1体撃破: +10pt（基本）
- スコアブースター無しで1分間プレイ: 約60pt（敵6体撃破想定）
- スコアブースターLv.3装備時: 約120pt/分

### 3.2 パーツ別価格表（全体）

| パーツ名 | Lv.1 | Lv.2 | Lv.3 | 合計コスト | 稼ぎ時間（基本/ブースト有） |
|---------|------|------|------|-----------|---------------------------|
| レーザーキャノン | 50pt | 120pt | 250pt + ボス1 | 420pt | 7分 / 3.5分 |
| マルチショット | 80pt | 180pt | 350pt + ボス1 | 610pt | 10分 / 5分 |
| ホーミングミサイル | 150pt | 300pt | 500pt + ボス1 | 950pt | 16分 / 8分 |
| シールドジェネレーター | 60pt | 140pt | 280pt + ボス1 | 480pt | 8分 / 4分 |
| アーマープレート | 70pt | 160pt | 320pt + ボス1 | 550pt | 9分 / 4.5分 |
| オートリペア | 100pt | 220pt | 450pt + ボス1 | 770pt | 13分 / 6.5分 |
| ブースター | 40pt | 100pt | 200pt + ボス1 | 340pt | 6分 / 3分 |
| クイックターン | 50pt | 110pt | 230pt + ボス1 | 390pt | 6.5分 / 3.3分 |
| スコアブースター | 90pt | 200pt | 400pt + ボス2 | 690pt | 11.5分 / - |
| シールドリチャージ | 120pt | 260pt | 520pt + ボス2 | 900pt | 15分 / 7.5分 |

### 3.3 推奨購入ルート（初心者向け）

**序盤（最初の100pt）**:
1. ブースター Lv.1（40pt）← 移動速度UPで生存率向上
2. シールドジェネレーター Lv.1（60pt）← HP増加で安心感

**中盤（100～500pt）**:
3. レーザーキャノン Lv.1-2（170pt）← 射程・弾速UPで安全に
4. マルチショット Lv.1（80pt）← 連射速度UPで火力増
5. スコアブースター Lv.1（90pt）← 以降の稼ぎ効率UP

**終盤（500pt～）**:
6. 各パーツをLv.2-3へ強化
7. ボス戦でボスコアを集める
8. お気に入りパーツをLv.3へ最終強化

### 3.4 価格設定の根拠

**設計指針**:
- **Lv.1**: 初プレイ1-2分で購入可能（40-150pt）
  → すぐに成長を実感できる

- **Lv.2**: 初プレイ2-5分の蓄積で購入可能（100-300pt）
  → 「もう少し頑張れば...」と思わせる

- **Lv.3**: 初プレイ5-15分の蓄積（200-520pt）+ ボス素材
  → エンドコンテンツ感、達成感を演出

**カテゴリ別価格傾向**:
- **機動系**: 安価（機動力は基本性能）
- **武器系**: 中価格（攻撃は楽しさの核）
- **防御系**: 中～高価格（必須ではないが安定性向上）
- **特殊系**: 高価格（贅沢品、やりこみ要素）

---

## 4. ゲームバランス懸念点と対策

### 4.1 強化しすぎて簡単になりすぎないか

#### 懸念:
全パーツをLv.3にすると、通常敵が雑魚化して面白みが失われる

#### 対策:
**1. 敵の段階的強化システム導入**
```typescript
interface EnemyProgression {
  wave: number        // ゲーム進行度（撃破数ベース）
  enemyType: string   // 'normal' | 'fast' | 'armored' | 'boss'
  hpMultiplier: number
  speedMultiplier: number
  scoreMultiplier: number
}
```

| ゲーム進行 | 敵タイプ | HP | 速度 | スコア | 備考 |
|----------|---------|-----|------|-------|------|
| 0-20撃破 | 通常敵 | 1 | 1.0x | 10pt | 初期状態 |
| 21-50撃破 | 通常敵 + 速い敵(20%) | 1 | 1.3x | 12pt | 機動系パーツの価値向上 |
| 51-100撃破 | 通常敵 + 重装甲敵(30%) | 2 | 0.8x | 20pt | 火力パーツの必要性 |
| 101-150撃破 | 全タイプ混合 | 1-3 | 0.8-1.5x | 10-30pt | バランス調整必須 |
| 150撃破～ | ボス戦挑戦可能 | - | - | - | ボス素材獲得 |

**2. スコアボーナスによる難易度選択**
- 強いパーツを装備 → 簡単になる → スコア獲得は通常通り
- 弱いパーツで挑戦 → 難しい → スコアブースターで効率的に稼げる
→ プレイヤーが自分で難易度を調整できる

**3. ボス戦での真価発揮**
- 通常敵は強化で楽になるが、ボス戦は別バランス
- ボスHP: 200-500（Lv.3パーツでも30秒～1分かかる）
- ボス攻撃パターン: 複数の弾幕攻撃（回避必須）

### 4.2 初期が難しすぎないか

#### 懸念:
パーツ未強化の初期状態が難しすぎて、初心者が挫折する

#### 対策:
**1. チュートリアル報酬で初期ブースト**
```typescript
const tutorialRewards = {
  firstPlay: 50pt,           // 初回プレイボーナス
  first10Kills: 30pt,        // 初の10体撃破
  surviveOneMinute: 20pt,    // 1分生存
  // 合計100pt → 初期パーツ購入可能
}
```

**2. 初期難易度の調整**
- 最初の20体までは敵出現間隔を長く（2.5秒 → 1.6秒に段階的短縮）
- 最初の10体は低速敵のみ（速度0.7x）
- 初期HP 100は妥当（敵10発耐える = 初心者でも30秒は生存可能）

**3. リスタート時のボーナス**
```typescript
const restartBonus = {
  keepPercentage: 0.5,  // GameOver時、スコアの50%を次回持ち越し
  maxCarryOver: 100pt   // 最大100ptまで
}
```
→ 何度か挑戦すれば必ず初期パーツが買える設計

### 4.3 「次のパーツが欲しい」と思わせる魅力

#### 懸念:
パーツを買っても「変化を感じない」「次が欲しくならない」

#### 対策:
**1. 視覚的フィードバックの強化**
- パーツ装備時: 機体の色変化・エフェクト追加
  - 武器系: 弾の色・サイズ変化（Lv.1:青→Lv.2:紫→Lv.3:金）
  - 防御系: シールドエフェクト表示
  - 機動系: スラスター光量UP
  - 特殊系: 特殊エフェクト

**2. 効果の体感性向上**
- 連射速度UP: 音のテンポ変化（タタタ → タタタタタ）
- 移動速度UP: カメラシェイク・残像エフェクト
- HP UP: HUD表示が緑色→青色→金色に変化

**3. パーツ間のシナジー設計**
```typescript
// 例: ホーミングミサイル + スコアブースター
const synergyBonus = {
  'HomingMissile_ScoreBooster': {
    description: '誘導弾で確実に撃破 → スコア効率最大化',
    bonus: '実質スコア2.6倍（ホーミング確実撃破 × スコアブースター2.0x）'
  }
}
```

**4. パーツ解説の充実**
- ショップUIで「このパーツでできること」を具体的に表示
  - 例: 「ブースターLv.2なら、敵の弾幕を左右に回避できます」
  - 例: 「マルチショットLv.3なら、画面の敵を一掃できます」

---

## 5. 実装優先度とロードマップ

### Phase 3.1: コア実装（1週目）
- [ ] Shop.ts: ショップUI実装（パーツリスト、購入処理）
- [ ] PartsManager.ts: パーツ装備・強化管理
- [ ] 基本パーツ3種実装（レーザーキャノン、シールド、ブースター）
- [ ] セーブ/ロード機能（localStorage使用）

### Phase 3.2: パーツ拡張（2週目）
- [ ] 残り7種のパーツ実装
- [ ] ボスコアシステム実装
- [ ] パーツ装備時の視覚エフェクト追加
- [ ] チュートリアル報酬システム

### Phase 3.3: バランス調整（3週目）
- [ ] 敵の段階的強化システム実装
- [ ] プレイテスト（10回以上）
- [ ] 価格・効果の微調整
- [ ] リスタートボーナス実装

---

## 6. データ構造（実装用）

### 6.1 パーツデータ定義
```typescript
interface PartDefinition {
  id: string
  name: string
  nameJP: string
  category: 'weapon' | 'defense' | 'mobility' | 'special'
  description: string
  levels: PartLevel[]
}

interface PartLevel {
  level: number
  price: number
  bossCoreCost: number
  stats: Record<string, number>
  description: string
}

// 例: レーザーキャノン
const laserCannonData: PartDefinition = {
  id: 'laser_cannon',
  name: 'Laser Cannon',
  nameJP: 'レーザーキャノン',
  category: 'weapon',
  description: '射程距離と弾速を強化する基本武器',
  levels: [
    { level: 0, price: 0, bossCoreCost: 0,
      stats: { damage: 1, range: 50, bulletSpeed: 40 },
      description: '初期装備' },
    { level: 1, price: 50, bossCoreCost: 0,
      stats: { damage: 1, range: 60, bulletSpeed: 40 },
      description: '射程距離+20%' },
    { level: 2, price: 120, bossCoreCost: 0,
      stats: { damage: 1, range: 70, bulletSpeed: 52 },
      description: '射程距離+40%、弾速+30%' },
    { level: 3, price: 250, bossCoreCost: 1,
      stats: { damage: 2, range: 80, bulletSpeed: 60 },
      description: 'ダメージ2倍、射程距離+60%、弾速+50%' }
  ]
}
```

### 6.2 プレイヤーパーツ状態
```typescript
interface PlayerPartsState {
  score: number
  bossCore: number
  equippedParts: {
    [partId: string]: number  // partId -> level
  }
}

// 例
const exampleState: PlayerPartsState = {
  score: 350,
  bossCore: 2,
  equippedParts: {
    'laser_cannon': 2,
    'shield_generator': 1,
    'booster': 1
  }
}
```

---

## 7. まとめと次のアクション

### 7.1 設計の要点
1. **10種類のパーツ** を4カテゴリに分類（武器、防御、機動、特殊）
2. **4段階強化システム**（Lv.0-3）、Lv.3はボスコア必須
3. **段階的な価格設計** で「次が欲しい」と思わせる心理設計
4. **敵の段階的強化** で「強化しすぎ問題」を回避
5. **チュートリアル報酬** で初期ハードル軽減

### 7.2 次のアクション（PeerB実装）
1. `/src/core/PartsManager.ts` 作成 - パーツデータ・状態管理
2. `/src/data/partsData.ts` 作成 - 上記パーツ定義を全てデータ化
3. `/src/ui/Shop.ts` 作成 - ショップUI実装
4. `/src/core/Player.ts` 拡張 - パーツ効果をPlayer/Bulletに反映
5. テスト作成 - PartsManager.test.ts, Shop.test.ts

### 7.3 未解決の検討事項（Phase 4へ持ち越し）
- [ ] ボス攻撃パターン詳細設計（別Aux依頼）
- [ ] ボスコアのビジュアル演出
- [ ] パーツ装備画面のUI詳細デザイン
- [ ] サウンドエフェクトの仕様

---

**作成者**: Claude (Aux Session planning-001)
**レビュー**: PeerA review pending
**承認**: PeerA approval pending
